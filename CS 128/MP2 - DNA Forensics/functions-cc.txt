#include "functions.hpp"

#include <fstream>
#include <iostream>
#include <map>
#include <string>
using namespace std;

int FrequencyFinder(string strand, string input) {
  vector<int> possibilities;
  int output = 0;

  for (unsigned int i = 0; i < input.size() - strand.length() + 1; i++) {
    if (input.substr(i, strand.length()) == strand) {
      output++;
      i += strand.length() - 1;
    } else if (output > 0) {
      possibilities.push_back(output);
      output = 0;
    }
  }

  possibilities.push_back(output);
  output = 0;

  for (unsigned int i = 0; i < possibilities.size(); i++)
    if (possibilities[i] > output)
      output = possibilities[i];

  return output;
}

string FindMatchingDNA(vector<vector<string>> table, string sequence) {
  vector<int> frequencies;

  for (unsigned int i = 1; i < table[0].size(); i++)
    frequencies.push_back(FrequencyFinder(table[0][i], sequence));

  vector<vector<int>> number_table;
  vector<int> filler;

  for (unsigned int i = 1; i < table.size(); i++) {
    for (unsigned int j = 1; j < table[i].size(); j++)
      filler.push_back(stoi(table[i][j]));

    number_table.push_back(filler);
    filler.clear();
  }

  for (unsigned int i = 1; i < table.size(); i++)
    if (number_table[i - 1] == frequencies)
      return table[i][0];

  return "No match";
}